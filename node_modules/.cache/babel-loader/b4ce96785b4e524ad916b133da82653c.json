{"ast":null,"code":"import _regeneratorRuntime from\"/Users/janakozachka/Documents/GitHub/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/janakozachka/Documents/GitHub/goit-react-hw-08-phonebook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from'axios';import authActions from'./auth-actions';axios.defaults.baseURL='https://connections-api.herokuapp.com';var token={set:function set(token){axios.defaults.headers.common.Authorization=\"Bearer \".concat(token);},unset:function unset(){axios.defaults.headers.common.Authorization='';}};var register=function register(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(authActions.registerRequest());_context.prev=1;_context.next=4;return axios.post('/users/signup',credentials);case 4:response=_context.sent;token.set(response.data.token);dispatch(authActions.registerSuccess(response.data));_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch(authActions.registerError(_context.t0.message));case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function(_x){return _ref.apply(this,arguments);};}();};var logIn=function logIn(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(authActions.loginRequest());_context2.prev=1;_context2.next=4;return axios.post('/users/login',credentials);case 4:response=_context2.sent;token.set(response.data.token);dispatch(authActions.loginSuccess(response.data));_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);dispatch(authActions.loginError(_context2.t0.message));case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};var logOut=function logOut(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(authActions.logoutRequest());_context3.prev=1;_context3.next=4;return axios.post('/users/logout');case 4:token.unset();dispatch(authActions.logoutSuccess());_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);dispatch(authActions.logoutError(_context3.t0.message));case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var getCurrentUser=function getCurrentUser(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var _getState,persistedToken,response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_getState=getState(),persistedToken=_getState.auth.token;if(persistedToken){_context4.next=3;break;}return _context4.abrupt(\"return\");case 3:token.set(persistedToken);dispatch(authActions.getCurrentUserRequest());_context4.prev=5;_context4.next=8;return axios.get('/users/current');case 8:response=_context4.sent;dispatch(authActions.getCurrentUserSuccess(response.data));_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](5);dispatch(authActions.getCurrentUserError(_context4.t0.message));case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[5,12]]);}));return function(_x4,_x5){return _ref4.apply(this,arguments);};}();};// eslint-disable-next-line \nexport default{register:register,logIn:logIn,logOut:logOut,getCurrentUser:getCurrentUser};","map":{"version":3,"sources":["/Users/janakozachka/Documents/GitHub/goit-react-hw-08-phonebook/src/redux/auth/auth-operations.js"],"names":["axios","authActions","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","dispatch","registerRequest","post","response","data","registerSuccess","registerError","message","logIn","loginRequest","loginSuccess","loginError","logOut","logoutRequest","logoutSuccess","logoutError","getCurrentUser","getState","persistedToken","auth","getCurrentUserRequest","get","getCurrentUserSuccess","getCurrentUserError"],"mappings":"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","sourcesContent":["import axios from 'axios';\nimport authActions from './auth-actions';\n\naxios.defaults.baseURL = 'https://connections-api.herokuapp.com';\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  },\n};\n\nconst register = credentials => async dispatch => {\n  dispatch(authActions.registerRequest());\n\n  try {\n    const response = await axios.post('/users/signup', credentials);\n\n    token.set(response.data.token);\n    dispatch(authActions.registerSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.registerError(error.message));\n  }\n};\n\nconst logIn = credentials => async dispatch => {\n  dispatch(authActions.loginRequest());\n\n  try {\n    const response = await axios.post('/users/login', credentials);\n\n    token.set(response.data.token);\n    dispatch(authActions.loginSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.loginError(error.message));\n  }\n};\n\nconst logOut = () => async dispatch => {\n  dispatch(authActions.logoutRequest());\n\n  try {\n    await axios.post('/users/logout');\n\n    token.unset();\n    dispatch(authActions.logoutSuccess());\n  } catch (error) {\n    dispatch(authActions.logoutError(error.message));\n  }\n};\n\nconst getCurrentUser = () => async (dispatch, getState) => {\n  const {\n    auth: { token: persistedToken },\n  } = getState();\n\n  if (!persistedToken) {\n    return;\n  }\n\n  token.set(persistedToken);\n  dispatch(authActions.getCurrentUserRequest());\n\n  try {\n    const response = await axios.get('/users/current');\n\n    dispatch(authActions.getCurrentUserSuccess(response.data));\n  } catch (error) {\n    dispatch(authActions.getCurrentUserError(error.message));\n  }\n};\n// eslint-disable-next-line \nexport default { register, logIn, logOut, getCurrentUser };"]},"metadata":{},"sourceType":"module"}